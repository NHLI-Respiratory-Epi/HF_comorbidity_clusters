library(poLCA)
library(dplyr)
library(ggplot2)
library(reshape2)
library(forcats)
library(Hmisc)

df<-readRDS("dataset.rds")

# Format dataset for poLCA

df_lca <- df %>%
  dplyr::select(CM_CAD, CM_AF, CM_LIVERDISEASE, CM_CANCER, CM_PAD,
                CM_RENALFAIL, CM_DIABETES, CM_HYPERTENSION_DIAG,  
                CM_CVA, CM_PEPTIC,  CM_DEPRESSION, CM_ALCOHOL,
                CM_ANEMIA,  CM_OBESITY, CM_COPD, CM_DEMENTIA)

df_lca$CM_AF<-ifelse(df_lca$CM_AF==0 , 1, 2) #1=no comorbidity present; 2= comorbidity present
df_lca$CM_CAD<-ifelse(df_lca$CM_CAD==0 , 1, 2)
df_lca$CM_LIVERDISEASE<-ifelse(df_lca$CM_LIVERDISEASE==0 , 1, 2)
df_lca$CM_CANCER<-ifelse(df_lca$CM_CANCER==0 , 1, 2)
df_lca$CM_PAD<-ifelse(df_lca$CM_PAD==0 , 1, 2)
df_lca$CM_RENALFAIL<-ifelse(df_lca$CM_RENALFAIL==0 , 1, 2)
df_lca$CM_DIABETES<-ifelse(df_lca$CM_DIABETES==0 , 1, 2)
df_lca$CM_HYPERTENSION_DIAG<-ifelse(df_lca$CM_HYPERTENSION_DIAG==0 , 1, 2)
df_lca$CM_CVA<-ifelse(df_lca$CM_CVA==0 , 1, 2)
df_lca$CM_PEPTIC<-ifelse(df_lca$CM_PEPTIC==0 , 1, 2)
df_lca$CM_DEPRESSION<-ifelse(df_lca$CM_DEPRESSION==0 , 1, 2)
df_lca$CM_ALCOHOL<-ifelse(df_lca$CM_ALCOHOL==0 , 1, 2)
df_lca$CM_ANEMIA<-ifelse(df_lca$CM_ANEMIA==0 , 1, 2)
df_lca$CM_OBESITY<-ifelse(df_lca$CM_OBESITY==0 , 1, 2)
df_lca$CM_COPD<-ifelse(df_lca$CM_COPD==0, 1, 2)
